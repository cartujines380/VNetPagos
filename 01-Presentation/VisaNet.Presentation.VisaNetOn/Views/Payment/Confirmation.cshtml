@using System.Globalization
@using VisaNet.Common.Resource.Presentation
@using VisaNet.Utilities.Exportation.ExtensionMethods

@model VisaNet.Presentation.VisaNetOn.Models.ConfirmationModel

<div class="col-xs-12 col-sm-7 col-md-7 front">
    <div class="wrapper-top">
        <i class="fa fa-check green"></i> <span class="green success-title">Pago Confirmado.</span>
        <span>Conserva tu comprobante, el pago fue completado exitosamente.</span>
        <span class="gray">N° de transacción <span class="green">@Model.Transaction</span></span>
    </div>
    <div class="wrapper-buttons">
        @if (!Model.IsAutogeneratedEmail && Model.SendEmail)
        {
            <span>Se enviará un comprobante de pago a tu correo electrónico "@Model.Email"</span>
        }
        <div class="col-xs-5 pull-right" style="padding-left: 0">
            <a id="downloadTicket" class="btn btn-block btn-primary w50 mt20" target="_blank" href="@Url.Action("DownloadTicket", "Payment", new {id = Model.UserId, transactionNumber = Model.Transaction})">
                Descargar <i class="fa fa-download"></i>
            </a>
        </div>
    </div>
</div>

<div class="col-sm-5 col-md-5">
    <div class="wrapper-comprobante">
        <span class="title-comprobante">Pago de <b>@Model.ServiceName</b></span>
        <hr />
        <span>@Model.Date - @Model.Hrs</span>
        <div class="body-comprobante">
            <span class="hidden-xs"><b class="blue">N° de transacción:</b> @Model.Transaction</span>
            <span><b class="blue">@PresentationWebStrings.Confirmation_Total_Bills:</b> @Model.Currency @Model.Amount</span>
            @if (Model.Discount > 0)
            {
                <span><b class="blue">@Model.DiscountTypeText</b> @Model.Currency @Model.Discount.SignificantDigits(2).ToString("##,#0.00", CultureInfo.CurrentCulture)</span>
                <span class="hidden-xs"><b class="blue">@PresentationWebStrings.Confirmation_Total_After_Discount:</b> @Model.Currency @((Model.TotalAmount - Model.Discount).SignificantDigits(2).ToString("##,#0.00", CultureInfo.CurrentCulture))</span>
            }
            <span><b class="blue">@PresentationWebStrings.Confirmation_Mask:</b> @Model.Mask</span>
            @if (Model.Quotas > 1)
            {
                <span class="hidden-xs"><b class="blue">@PresentationWebStrings.Quota:</b> @Model.Quotas</span>
            }
        </div>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $("#stepConfirm").addClass("active");
        $("#sendEmail").click(function (e) {
            //Envia los datos para validar
            e.preventDefault();
            $.post(this.getAttribute('href')).done(validationMethod);
        });

        var validationMethod = function (data) {
            showNotification(data.Message, data.NotificationType);
        };
    });
</script>
